<?php if(!function_exists('tpl_block_area')){ require(CORE_DIR.'/admin/smartyplugin/block.area.php'); } if(!function_exists('tpl_modifier_escape')){ require(CORE_DIR.'/include_v5/smartyplugins/modifier.escape.php'); }  if( count($this->_vars['diff']) ){  $this->_tag_stack[] = array('tpl_block_area', array('inject' => ".mainHead")); tpl_block_area(array('inject' => ".mainHead"), null, $this); ob_start(); ?> <div class="notice"> 数据库存在错误. <button onclick="W.page('index.php?ctl=system/debug&act=fix_database')" type="button" class="btn"><span><span><img src="images/transparent.gif" class="imgbundle icon" style="width:16px;height:16px;background-position:0 -1623px;" />立即修复</span></span></button> </div> <?php $_block_content = ob_get_contents(); ob_end_clean(); $_block_content = tpl_block_area($this->_tag_stack[count($this->_tag_stack) - 1][1], $_block_content, $this); echo $_block_content; array_pop($this->_tag_stack); $_block_content='';  foreach ((array)$this->_vars['diff'] as $this->_vars['tbname'] => $this->_vars['diffsql']){ ?> <fieldset> <legend><?php echo $this->_vars['tbname']; ?></legend> <pre>
<?php foreach ((array)$this->_vars['diffsql'] as $this->_vars['sql']){  echo tpl_modifier_escape($this->_vars['sql'],'html');  } ?>
</pre> </fieldset> <?php } ?> </div> <?php }else{ ?> <div class="tableform"> <p class="notice"> 数据库结构一切正常 </p> </div> <?php } ?>